<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>GAARA FF TOOL - Login</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">

  <!-- TODO: put your real Google OAuth client id here -->
  <meta name="google-signin-client_id" content="337593306198-f2rjaghhmustluqiskftahagmbnmaqoh.apps.googleusercontent.com">

  <!-- Google Identity Services script -->
  <script src="https://accounts.google.com/gsi/client" async defer></script>

  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <style>
    :root {
      --bg: #050816;
      --accent: #4f75df;
      --accent-2: #6621d6;
      --text: #6396fd;
      --muted: #94a3b8;
    }
    * { box-sizing:border-box; margin:0; padding:0; }
    body{
      font-family: system-ui,-apple-system,BlinkMacSystemFont,"Segoe UI",sans-serif;
      min-height:100vh;
      display:flex;
      align-items:center;
      justify-content:center;
      background:radial-gradient(circle at top,#111827 0,#020617 60%,#000 100%);
      color:var(--text);
      padding:16px;
    }
    /* Toast */
    #toast{
      position:fixed;
      top:12px;
      left:50%;
      transform:translateX(-50%);
      background:rgba(15,23,42,.98);
      border-radius:999px;
      padding:8px 14px;
      display:flex;
      align-items:center;
      gap:6px;
      color:#e5e7eb;
      font-size:14px;
      box-shadow:0 18px 45px rgba(0,0,0,.7);
      opacity:0;
      pointer-events:none;
      transition:.25s ease;
      z-index:9999;
    }
    #toast.show{opacity:1; transform:translateX(-50%) translateY(4px);}
    #toast i{font-size:15px;}
    #toast.error{border:1px solid rgba(248,113,113,.7);}
    #toast.error i{color:#f97373;}
    #toast.success{border:1px solid rgba(74,222,128,.7);}
    #toast.success i{color:#4ade80;}

    .login-shell{
      width:100%;
      max-width:440px;
      position:relative;
    }

    .login-card{
      background:linear-gradient(135deg,#020617,#02030a);
      border-radius:22px;
      border:1px solid rgba(148,163,184,.4);
      box-shadow:0 30px 80px rgba(0,0,0,.9);
      padding:18px 18px 16px;
      position:relative;
      overflow:hidden;
      display:flex;
      flex-direction:column;
      gap:12px;
      min-height:480px;
    }
    .login-card::before{
      content:"";
      position:absolute;
      inset:-40%;
      background:radial-gradient(circle at top,#4338ca 0,transparent 55%);
      opacity:.25;
      pointer-events:none;
    }

    .login-header{
      display:flex;
      align-items:center;
      justify-content:space-between;
      margin-bottom:4px;
      position:relative;
      z-index:1;
    }
    .login-title{
      display:flex;
      flex-direction:column;
      gap:3px;
    }
    .login-title h1{
      font-size:20px;
      letter-spacing:.15em;
      text-transform:uppercase;
      color: #22d3ee;
    }
    .login-title span{
      font-size:11px;
      color:var(--muted);
    }

    .profile-btn{
      width:40px;
      height:40px;
      border-radius:999px;
      border:2px solid rgba(148,163,184,.7);
      overflow:hidden;
      padding:0;
      background:transparent;
      cursor:pointer;
      display:flex;
      align-items:center;
      justify-content:center;
      position:relative;
      z-index:1;
    }
    .profile-btn img{
      width:100%;
      height:100%;
      object-fit:cover;
      display:block;
    }

    .section-title{
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:.18em;
      color:var(--muted);
      margin-top:8px;
      margin-bottom:6px;
      position:relative;
      z-index:1;
    }

    .google-login-wrapper{
      position:relative;
      z-index:1;
      display:flex;
      justify-content:center;
      margin-bottom:8px;
    }

    .btn-primary{
      width:100%;
      margin-top:4px;
      padding:9px 10px;
      border-radius:14px;
      border:none;
      background:linear-gradient(135deg,var(--accent),var(--accent-2));
      color:#fff;
      font-weight:600;
      font-size:14px;
      cursor:pointer;
      position:relative;
      z-index:1;
      display:flex;
      align-items:center;
      justify-content:center;
      gap:6px;
    }
    .btn-primary:active{transform:scale(.98);}

    .helper-row{
      font-size:12px;
      color:var(--muted);
      text-align:center;
      position:relative;
      z-index:1;
      margin-top:4px;
    }
    .helper-row strong{
      color:#60a5fa;
    }

    .acess_tkn{
      font-size:12px;
      color:var(--muted);
      text-align:center;
      position:relative;
      z-index:1;
    }
    .acess_tkn a{
      color:#60a5fa;
      text-decoration:none;
      font-weight:600;
    }
    .acess_tkn a:hover{text-decoration:underline;}

    .social-bar{
      margin-top:auto;
      position:relative;
      z-index:1;
      display:flex;
      justify-content:center;
    }
    .social-icons {
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:center;
    }
    .icon-btn {
      width:34px;
      height:34px;
      border-radius:999px;
      border:1px solid rgba(148,163,184,0.7);
      display:flex;
      align-items:center;
      justify-content:center;
      background:#020617;
      transition:0.12s;
    }
    .icon-btn:hover {
      transform:translateY(-2px);
      border-color:#689dff;
    }
    .icon-btn img {
      width:20px;
      height:20px;
    }

    /* ID/PASSWORD FORM */
    .form-grid{
      position:relative;
      z-index:1;
      display:flex;
      flex-direction:column;
      gap:8px;
      margin-top:4px;
    }
    .field{
      display:flex;
      flex-direction:column;
      gap:4px;
    }
    .field label{
      font-size:11px;
      color:var(--muted);
    }
    .field input{
      width:100%;
      padding:7px 10px;
      border-radius:12px;
      border:1px solid rgba(148,163,184,.55);
      background:rgba(15,23,42,.9);
      color:var(--text);
      font-size:13px;
      outline:none;
    }
    .field input:focus{
      border-color:#60a5fa;
      box-shadow:0 0 0 1px rgba(59,130,246,.4);
    }

    .divider{
      display:flex;
      align-items:center;
      justify-content:center;
      gap:8px;
      margin-top:10px;
      margin-bottom:2px;
      position:relative;
      z-index:1;
      color:var(--muted);
      font-size:11px;
      text-transform:uppercase;
      letter-spacing:.18em;
    }
    .divider span{white-space:nowrap;}
    .divider::before,
    .divider::after{
      content:"";
      flex:1;
      height:1px;
      background:linear-gradient(to right,transparent,rgba(148,163,184,.6));
    }
    .divider::after{
      background:linear-gradient(to left,transparent,rgba(148,163,184,.6));
    }

    /* Loading screen */
    #loading-screen{
      position:fixed;
      inset:0;
      background:radial-gradient(circle at top,#020617 0,#000 70%);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:9998;
    }
    #loading-screen.show{display:flex;}
    .loading-inner{
      display:flex;
      flex-direction:column;
      align-items:center;
      gap:14px;
    }
    .loading-ring{
      width:110px;
      height:110px;
      border-radius:999px;
      border:3px solid rgba(148,163,184,.3);
      position:relative;
      display:flex;
      align-items:center;
      justify-content:center;
      overflow:hidden;
    }
    .loading-ring::before{
      content:"";
      position:absolute;
      inset:-4px;
      border-radius:inherit;
      border:3px solid transparent;
      border-top-color:#4f46e5;
      border-right-color:#22d3ee;
      animation:spin 1s linear infinite;
    }
    .loading-ring img{
      width:82px;
      height:82px;
      border-radius:999px;
      object-fit:cover;
      position:relative;
      z-index:1;
    }
    .loading-text{
      font-size:13px;
      color:var(--muted);
      letter-spacing:.15em;
      text-transform:uppercase;
    }
    .loading-text2{
      font-size:13px;
      text-align:center;
      color:var(--muted);
      letter-spacing:.15em;
      text-transform:uppercase;
    }
    @keyframes spin{
      to{transform:rotate(360deg);}
    }
  </style>
</head>
<body>
  <div id="toast"><i class="fa-solid fa-circle-info"></i><span></span></div>

  <!-- Loading screen shown after successful login -->
  <div id="loading-screen">
    <div class="loading-inner">
      <div class="loading-ring">
        <img src="profile-logo.jpg" alt="Logo">
      </div>
      <div class="loading-text">Loading Panel...</div>
      <div class="loading-text2">Project by GAARA</div>
    </div>
  </div>

  <div class="login-shell">
    <div class="login-card">
      <div class="login-header">
        <div class="login-title">
          <h1>GAARA FF TOOL</h1>
          <span>Login with Subscribed Gmail or ID PASS</span>
        </div>
        <button class="profile-btn">
          <img src="profile-logo.jpg" alt="Logo">
        </button>
      </div>


      <!-- GOOGLE SECTION -->
      <div class="divider">
        <span>Google sign in</span>
      </div>

      <div class="google-login-wrapper">
        <!-- This div configures the Google Identity Services client -->
        <div id="g_id_onload"
             data-client_id="YOUR_GOOGLE_CLIENT_ID"
             data-callback="handleCredentialResponse"
             data-auto_prompt="false">
        </div>

        <!-- This is the actual "Sign in with Google" button -->
        <div class="g_id_signin"
             data-type="standard"
             data-size="large"
             data-theme="outline"
             data-text="continue_with"
             data-shape="pill"
             data-logo_alignment="left">
        </div>
      </div>

      <button class="btn-primary" type="button" onclick="manualPrompt()">
        <i class="fa-brands fa-google"></i>
        Continue with Google
      </button>

      <div class="helper-row">
        Only <strong>Subscribed Gmail IDs</strong> or the <strong>ID PASS</strong> can access the panel.
      </div>

      <div class="divider">
        <span>Or use ID &amp; Password</span>
      </div>

      <!-- FIXED ID & PASSWORD SECTION -->
      <form class="form-grid" onsubmit="return handleIdLogin(event)">
        <div class="field">
          <label for="login-id">User ID</label>
          <input type="text" id="login-id" autocomplete="off" placeholder="Enter user ID">
        </div>
        <div class="field">
          <label for="login-pass">User Password</label>
          <input type="password" id="login-pass" autocomplete="off" placeholder="Enter user password">
        </div>
        <button class="btn-primary" type="submit">
          <i class="fa-solid fa-right-to-bracket"></i>
          Login with ID &amp; Password
        </button>
      </form>
      

     
      <div class="acess_tkn">
        <a href="https://ticket.kiosgamer.co.id/" target="_blank">get access token</a>
      </div>

      <div class="social-bar">
        <div class="social-icons">
          <a href="https://www.instagram.com/companion.1964" target="_blank" class="icon-btn" aria-label="Instagram">
            <img src="img/instagram.svg" alt="Instagram" />
          </a>
          <a href="https://t.me/+ODKM2z6hs_IzNWNl" target="_blank" class="icon-btn" aria-label="Telegram">
            <img src="img/telegram.svg" alt="Telegram" />
          </a>
          <a href="https://discord.gg/j2vMYyFKFC" target="_blank" class="icon-btn" aria-label="Discord">
            <img src="img/discord.svg" alt="Discord" />
          </a>
          <a href="https://www.youtube.com/@COMPANION1964" target="_blank" class="icon-btn" aria-label="YouTube">
            <img src="img/youtube.svg" alt="YouTube" />
          </a>
        </div>
      </div>

    </div>
  </div>

  <script>
    let toastTimeout;

    function showToast(msg, type='error', time=2000){
      const t = document.getElementById('toast');
      const span = t.querySelector('span');
      const icon = t.querySelector('i');
      span.textContent = msg;
      t.className = '';
      t.classList.add(type === 'success' ? 'success' : 'error');
      icon.className = 'fa-solid ' + (type === 'success' ? 'fa-circle-check' : 'fa-circle-xmark');
      t.classList.add('show');
      clearTimeout(toastTimeout);
      toastTimeout = setTimeout(()=>t.classList.remove('show'), time);
    }

    const loadingScreen = document.getElementById('loading-screen');

    // TODO: put the Gmail addresses that are allowed to login
    const ALLOWED_EMAILS = [
      "shaikhsaadsultanali2004@gmail.com",
      "shaikhsaadsultanali12004@gmail.com"
      // add more here
    ];

    // TODO: fixed master ID & password
    const MASTER_ID = "GAARA";       // change this
    const MASTER_PASSWORD = "1919";  // change this

    function startSuccessFlow(message){
      showToast(message, "success", 1200);
      sessionStorage.setItem('GAARA_ONE_TIME_TOKEN', String(Date.now()));
      loadingScreen.classList.add('show');
      setTimeout(()=>{
        window.location.href = 'main.html';
      }, 1500);
    }

    // Decode JWT token from Google to get email
    function parseJwt (token) {
      try {
        const base64Url = token.split('.')[1];
        const base64 = base64Url.replace(/-/g, '+').replace(/_/g, '/');
        const jsonPayload = decodeURIComponent(atob(base64).split('').map(function(c) {
          return '%' + ('00' + c.charCodeAt(0).toString(16)).slice(-2);
        }).join(''));
        return JSON.parse(jsonPayload);
      } catch (e) {
        console.error("JWT parse error", e);
        return null;
      }
    }

    // Called by Google Identity Services when user signs in
    function handleCredentialResponse(response) {
      const data = parseJwt(response.credential || "");
      if (!data) {
        showToast("Failed to read Google login. Try again.");
        return;
      }

      const email = data.email;
      if (!email) {
        showToast("Google account has no visible email.", "error");
        return;
      }

      // Check if email is in your whitelist
      if (!ALLOWED_EMAILS.includes(email)) {
        showToast("This Gmail is not authorized for GAARA TOOL.", "error");
        return;
      }

      startSuccessFlow("Google login success: " + email);
    }

    // Optional: manually trigger Google's one-tap / prompt when clicking the big button
    function manualPrompt() {
      if (window.google && google.accounts && google.accounts.id) {
        google.accounts.id.prompt();
      } else {
        showToast("Google login not loaded yet. Try again in a moment.");
      }
    }

    // ID & PASSWORD LOGIN HANDLER
    function handleIdLogin(e){
      e.preventDefault();
      const id = (document.getElementById('login-id').value || "").trim();
      const pass = (document.getElementById('login-pass').value || "").trim();

      if (!id || !pass){
        showToast("Please enter both ID and password.");
        return false;
      }

      if (id === MASTER_ID && pass === MASTER_PASSWORD){
        startSuccessFlow("login successful.");
      } else {
        showToast("Invalid ID or pass Follow me for ID PASS.");
      }

      return false;
    }

    // Initialize Google Identity Services once script is loaded
    window.onload = function() {
      const clientIdMeta = document.querySelector('meta[name="google-signin-client_id"]');
      const clientId = clientIdMeta ? clientIdMeta.content : "YOUR_GOOGLE_CLIENT_ID";

      if (window.google && google.accounts && google.accounts.id) {
        google.accounts.id.initialize({
          client_id: clientId,
          callback: handleCredentialResponse
        });
      }
    };
  </script>
</body>
</html>
